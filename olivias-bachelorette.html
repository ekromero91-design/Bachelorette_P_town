<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Olivia's Bachelorette Extravaganza</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #ff6b6b, #ff8e8e, #ffa8a8);
            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            text-align: center;
            position: relative;
        }
        
        h1 {
            color: #FFD700;
            font-size: 3rem;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 1rem;
            line-height: 1.2;
        }
        
        .venmo-cta {
            color: #3D95CE;
            font-size: 1.2rem;
            margin-bottom: 2rem;
            font-weight: bold;
            opacity: 0;
            animation: fadeIn 1s ease 0.5s forwards;
        }
        
        .payment-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-bottom: 3rem;
            max-width: 600px;
        }
        
        .payment-btn {
            color: white;
            border: none;
            padding: 15px 25px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            min-width: 120px;
        }
        
        .payment-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        .btn-5 { background: linear-gradient(45deg, #ff6b6b, #ff8e8e); }
        .btn-10 { background: linear-gradient(45deg, #4ecdc4, #44b3a8); }
        .btn-15 { background: linear-gradient(45deg, #45b7d1, #3498db); }
        .btn-20 { background: linear-gradient(45deg, #96ceb4, #7fb69e); }
        .btn-25 { background: linear-gradient(45deg, #f9ca24, #f0932b); }
        
        .message-board {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 20px;
            margin: 20px;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .message-board h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }
        
        .message-form {
            margin-bottom: 20px;
        }
        
        .message-form input, .message-form textarea {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1rem;
            box-sizing: border-box;
        }
        
        .message-form button {
            background: linear-gradient(45deg, #B19CD9, #A08BD4);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .message-form button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(177, 156, 217, 0.4);
        }
        
        .messages {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        .message {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #B19CD9;
            position: relative;
        }
        
        .message-author {
            font-weight: bold;
            color: #B19CD9;
            margin-bottom: 5px;
        }
        
        .message-text {
            color: #333;
            line-height: 1.4;
        }
        
        .message-time {
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
        }
        
        .delete-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            cursor: pointer;
            font-size: 12px;
            display: none;
        }
        
        .admin-controls {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
        
        .admin-controls input {
            margin: 5px;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        
        .admin-controls button {
            margin: 5px;
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .login-btn {
            background: #28a745;
            color: white;
        }
        
        .logout-btn {
            background: #dc3545;
            color: white;
        }
        
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            display: none;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .floating-emoji {
            position: fixed;
            font-size: 30px;
            pointer-events: none;
            z-index: 1000;
            animation: floatUp 3s ease-out forwards;
        }
        
        @keyframes floatUp {
            0% {
                opacity: 1;
                transform: translateY(0px) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-200px) scale(1.5);
            }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes sparkle {
            0% { opacity: 1; transform: scale(0); }
            50% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(0); }
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
                padding: 0 20px;
            }
            
            .payment-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .payment-btn {
                font-size: 1rem;
                padding: 12px 20px;
                width: 200px;
            }
            
            .message-board {
                margin: 10px;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <h1>Welcome to Olivia's<br>Bachelorette Extravaganza</h1>
    
    <div class="venmo-cta">
        Would you like to Venmo... üíú
    </div>
    
    <div class="payment-buttons">
        <button class="payment-btn btn-5" onclick="buyDrink(5)">$5 üç∑</button>
        <button class="payment-btn btn-10" onclick="buyDrink(10)">$10 üç∏</button>
        <button class="payment-btn btn-15" onclick="buyDrink(15)">$15 üçπ</button>
        <button class="payment-btn btn-20" onclick="buyDrink(20)">$20 ü•Ç</button>
        <button class="payment-btn btn-25" onclick="buyDrink(25)">$25 üçæ</button>
    </div>
    
    <div class="message-board">
        <h2>üíå Messages for the Bride üíå</h2>
        
        <div class="admin-controls">
            <input type="password" id="adminPassword" placeholder="Admin Password" style="display: none;">
            <button id="adminToggle" class="login-btn" onclick="toggleAdmin()">Admin Login</button>
            <button id="adminLogout" class="logout-btn" onclick="logoutAdmin()" style="display: none;">Logout</button>
        </div>
        
        <div id="status" class="status"></div>
        
        <div class="message-form">
            <input type="text" id="messageAuthor" placeholder="Your name" maxlength="30">
            <textarea id="messageText" placeholder="Leave a sweet message for Olivia!" rows="3" maxlength="200"></textarea>
            <button onclick="submitMessage()">Send Message üíï</button>
        </div>
        
        <div id="messages" class="messages"></div>
    </div>
    
    <script>
        // === GLOBAL STATE ===
        let isAdminMode = false;
        let audioContext = null;
        
        // GitHub repository info
        const GITHUB_CONFIG = {
            owner: 'ekromero91-design',
            repo: 'Bachelorette_P_town',
            filePath: 'olivias-bachelorette.html'
        };
        
        // Embedded GitHub token for seamless message storage in code
        const githubToken = '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';
        
        // Messages array - stored directly in code and updated via GitHub commits!
        let messages = [];
        
        // Profanity filter
        const BLOCKED_WORDS = [
            'fuck', 'shit', 'damn', 'hell', 'ass', 'bitch', 'bastard', 'crap', 'piss', 'dick',
            'cock', 'pussy', 'slut', 'whore', 'fag', 'gay', 'lesbian', 'stupid', 'idiot', 'moron',
            'retard', 'loser', 'ugly', 'fat', 'skinny', 'bald', 'short', 'tall', 'old', 'young'
        ];
        
        const BLOCKED_PHRASES = [
            'fuck you', 'go to hell', 'shut up', 'you suck', 'i hate you', 'you are stupid',
            'you are ugly', 'you are fat', 'you are a loser', 'get lost', 'go away',
            'leave me alone', 'i don\'t like you', 'you are annoying', 'you are weird',
            'you are crazy', 'you are dumb', 'you are pathetic', 'you are a bitch',
            'you are a slut', 'you are a whore', 'don\'t marry', 'bad idea', 'terrible choice'
        ];
        
        // === AUDIO EFFECTS ===
        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }
        }
        
        function playCheerSound() {
            if (!audioContext) return;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
            oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1); // E5
            oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2); // G5
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.5);
        }
        
        // === VENMO PAYMENT FUNCTIONS ===
        function buyDrink(amount) {
            initAudio();
            playCheerSound();
            createHeartBurst();
            
            const notes = {
                5: 'Thanks for the wine! üç∑',
                10: 'Cheers to the bride! üç∏',
                15: 'Party time! üçπ',
                20: 'Celebration mode! ü•Ç',
                25: 'You\'re amazing! üçæ'
            };
            
            const note = notes[amount] || 'Cheers!';
            
            // Try mobile app deep link first
            const venmoAppUrl = `venmo://paycharge?txn=pay&recipients=shewerewolf&amount=${amount}&note=${encodeURIComponent(note)}`;
            
            // Fallback to web URL
            const venmoWebUrl = `https://venmo.com/u/shewerewolf?txn=pay&amount=${amount}&note=${encodeURIComponent(note)}`;
            
            // Try to open mobile app, fallback to web
            setTimeout(() => {
                window.location.href = venmoAppUrl;
                setTimeout(() => {
                    window.open(venmoWebUrl, '_blank');
                }, 500);
            }, 200);
        }
        
        function createHeartBurst() {
            const hearts = ['üíï', 'üíñ', 'üíó', 'üíò', 'üíù', 'üíû', 'üíü'];
            
            for (let i = 0; i < 8; i++) {
                setTimeout(() => {
                    const heart = document.createElement('div');
                    heart.innerHTML = hearts[Math.floor(Math.random() * hearts.length)];
                    heart.className = 'floating-emoji';
                    heart.style.left = (window.innerWidth / 2 + (Math.random() - 0.5) * 200) + 'px';
                    heart.style.top = (window.innerHeight / 2) + 'px';
                    document.body.appendChild(heart);
                    
                    setTimeout(() => heart.remove(), 3000);
                }, i * 100);
            }
        }
        
        // === MESSAGE FUNCTIONS ===
        function containsProfanity(text) {
            const lowerText = text.toLowerCase();
            
            // Check blocked phrases first
            for (const phrase of BLOCKED_PHRASES) {
                if (lowerText.includes(phrase)) {
                    return true;
                }
            }
            
            // Check individual words
            const words = lowerText.match(/\b\w+\b/g) || [];
            for (const word of words) {
                if (BLOCKED_WORDS.includes(word)) {
                    return true;
                }
            }
            
            return false;
        }
        
        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
            statusDiv.style.display = 'block';
            
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 5000);
        }
        
        async function submitMessage() {
            const authorInput = document.getElementById('messageAuthor');
            const textInput = document.getElementById('messageText');
            const author = authorInput.value.trim();
            const text = textInput.value.trim();
            
            if (!author || !text) {
                showStatus('Please fill in both name and message!', 'error');
                return;
            }
            
            if (containsProfanity(author) || containsProfanity(text)) {
                showStatus('Please keep messages appropriate and positive! üíï', 'error');
                return;
            }
            
            const message = {
                id: Date.now().toString(),
                author: author,
                text: text,
                timestamp: new Date().toISOString()
            };
            
            // Add to local array
            messages.unshift(message);
            
            // Clear form
            authorInput.value = '';
            textInput.value = '';
            
            // Update display
            displayMessages();
            
            // Try to sync to GitHub if admin has provided token
            if (githubToken) {
                try {
                    showStatus('Syncing message across devices...', 'info');
                    await commitMessagesToGitHub();
                    showStatus('Message saved and synced! üíï', 'success');
                } catch (error) {
                    console.error('GitHub sync failed:', error);
                    showStatus('Message saved locally. GitHub sync failed - check token.', 'error');
                }
            } else {
                showStatus('Message saved locally! (Admin: add GitHub token for cross-device sync)', 'success');
                // Save to localStorage as backup
                localStorage.setItem('bachelorette_messages', JSON.stringify(messages));
            }
        }
        
        async function deleteMessage(messageId) {
            if (!isAdminMode) return;
            
            messages = messages.filter(msg => msg.id !== messageId);
            displayMessages();
            
            if (githubToken) {
                try {
                    showStatus('Deleting message...', 'info');
                    await commitMessagesToGitHub();
                    showStatus('Message deleted and synced!', 'success');
                } catch (error) {
                    console.error('GitHub sync failed:', error);
                    showStatus('Message deleted locally. GitHub sync failed.', 'error');
                }
            } else {
                localStorage.setItem('bachelorette_messages', JSON.stringify(messages));
                showStatus('Message deleted locally!', 'success');
            }
        }
        
        function displayMessages() {
            const messagesDiv = document.getElementById('messages');
            messagesDiv.innerHTML = '';
            
            if (messages.length === 0) {
                messagesDiv.innerHTML = '<p style="color: #666; font-style: italic;">No messages yet. Be the first to leave a sweet message for Olivia! üíï</p>';
                return;
            }
            
            messages.forEach(message => {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message';
                messageDiv.innerHTML = `
                    <div class="message-author">${escapeHtml(message.author)}</div>
                    <div class="message-text">${escapeHtml(message.text)}</div>
                    <div class="message-time">${formatDate(message.timestamp)}</div>
                    ${isAdminMode ? `<button class="delete-btn" onclick="deleteMessage('${message.id}')">√ó</button>` : ''}
                `;
                
                if (isAdminMode) {
                    const deleteBtn = messageDiv.querySelector('.delete-btn');
                    if (deleteBtn) deleteBtn.style.display = 'block';
                }
                
                messagesDiv.appendChild(messageDiv);
            });
        }
        
        // === GITHUB INTEGRATION ===
        async function commitMessagesToGitHub() {
            if (!githubToken) {
                throw new Error('GitHub token not provided');
            }
            
            try {
                // Get current file content
                const response = await fetch(`https://api.github.com/repos/${GITHUB_CONFIG.owner}/${GITHUB_CONFIG.repo}/contents/${GITHUB_CONFIG.filePath}`, {
                    headers: {
                        'Authorization': `token ${githubToken}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`GitHub API error: ${response.status}`);
                }
                
                const fileData = await response.json();
                const currentContent = atob(fileData.content);
                
                // Update the messages array in the HTML content
                const messagesArrayRegex = /let messages = \[.*?\];/s;
                const newMessagesArray = `let messages = ${JSON.stringify(messages, null, 12)};`;
                const updatedContent = currentContent.replace(messagesArrayRegex, newMessagesArray);
                
                // Commit the updated file
                const commitResponse = await fetch(`https://api.github.com/repos/${GITHUB_CONFIG.owner}/${GITHUB_CONFIG.repo}/contents/${GITHUB_CONFIG.filePath}`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${githubToken}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        message: `Update messages - ${messages.length} total messages`,
                        content: btoa(updatedContent),
                        sha: fileData.sha
                    })
                });
                
                if (!commitResponse.ok) {
                    throw new Error(`GitHub commit error: ${commitResponse.status}`);
                }
                
                showStatus('Messages synced! GitHub Pages will update in ~1 minute.', 'success');
                
            } catch (error) {
                console.error('GitHub sync error:', error);
                throw error;
            }
        }
        
        // === ADMIN FUNCTIONS ===
        function toggleAdmin() {
            const passwordInput = document.getElementById('adminPassword');
            const toggleBtn = document.getElementById('adminToggle');
            const logoutBtn = document.getElementById('adminLogout');
            
            if (isAdminMode) {
                logoutAdmin();
                return;
            }
            
            if (passwordInput.style.display === 'none') {
                passwordInput.style.display = 'inline-block';
                toggleBtn.textContent = 'Login';
                passwordInput.focus();
            } else {
                const password = passwordInput.value;
                
                if (password === 'olivia2024') {
                    isAdminMode = true;
                    passwordInput.style.display = 'none';
                    toggleBtn.style.display = 'none';
                    logoutBtn.style.display = 'inline-block';
                    
                    displayMessages(); // Refresh to show delete buttons
                    showStatus('Admin mode: ON | GitHub sync: ENABLED', 'success');
                } else {
                    showStatus('Incorrect password!', 'error');
                    passwordInput.value = '';
                }
            }
        }
        
        function logoutAdmin() {
            isAdminMode = false;
            
            const passwordInput = document.getElementById('adminPassword');
            const toggleBtn = document.getElementById('adminToggle');
            const logoutBtn = document.getElementById('adminLogout');
            
            passwordInput.style.display = 'none';
            passwordInput.value = '';
            toggleBtn.style.display = 'inline-block';
            toggleBtn.textContent = 'Admin Login';
            logoutBtn.style.display = 'none';
            
            displayMessages(); // Refresh to hide delete buttons
            showStatus('Admin mode: OFF', 'info');
        }
        
        // === UTILITY FUNCTIONS ===
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        function formatDate(isoString) {
            const date = new Date(isoString);
            return date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        }
        
        // === SPARKLE EFFECTS ===
        function createSparkle() {
            const sparkle = document.createElement('div');
            sparkle.innerHTML = '‚ú®';
            sparkle.style.position = 'fixed';
            sparkle.style.left = Math.random() * window.innerWidth + 'px';
            sparkle.style.top = Math.random() * window.innerHeight + 'px';
            sparkle.style.fontSize = '20px';
            sparkle.style.pointerEvents = 'none';
            sparkle.style.animation = 'sparkle 2s linear forwards';
            document.body.appendChild(sparkle);
            
            setTimeout(() => {
                sparkle.remove();
            }, 2000);
        }
        
        function createFloatingEmoji() {
            const emojis = ['üéâ', 'üíñ', 'üåü', 'üí´', 'ü¶ã', 'üå∏', 'üíï', '‚ú®'];
            const emoji = document.createElement('div');
            emoji.innerHTML = emojis[Math.floor(Math.random() * emojis.length)];
            emoji.className = 'floating-emoji';
            emoji.style.left = Math.random() * window.innerWidth + 'px';
            emoji.style.top = window.innerHeight + 'px';
            document.body.appendChild(emoji);
            
            setTimeout(() => emoji.remove(), 3000);
        }
        
        // === INITIALIZATION ===
        document.addEventListener('DOMContentLoaded', function() {
            // Load messages from localStorage as fallback
            const savedMessages = localStorage.getItem('bachelorette_messages');
            if (savedMessages && messages.length === 0) {
                try {
                    messages = JSON.parse(savedMessages);
                } catch (e) {
                    console.error('Error loading saved messages:', e);
                }
            }
            
            displayMessages();
            
            // Initialize audio context on first user interaction
            document.addEventListener('click', initAudio, { once: true });
            document.addEventListener('touchstart', initAudio, { once: true });
            
            // Handle Enter key in admin password field
            document.getElementById('adminPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    toggleAdmin();
                }
            });
            
            // Handle Enter key in message form
            document.getElementById('messageText').addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    submitMessage();
                }
            });
        });
        
        // Create sparkles and floating emojis periodically
        setInterval(createSparkle, 1000);
        setInterval(createFloatingEmoji, 3000);
        
    </script>
</body>
</html>
